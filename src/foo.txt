S_i1 = zeros(length(L1),length(f));
S_i1_1 = zeros(1,length(f));
//объявили массивы, S_i1 промежуточный
S_i1_1 конечный, в котором будет храниться спектр последовательности сигналов
for i1 = 1:length(L1)
k_1 = L1(i1);
S_i1(i1, :) = S(k_1, :) .* exp(-1j*2*pi*f*i1*T);
end//проходимся циклом по массиву значений спектров одиночных сигналов, тем самым выполняя часть формулы, что под знаком суммы(т.е. прошлись, домножив на экспоненту, но еще не сложили все эти составляющие)
S_i1_1(1, :) = S_i1(1, :);// в конечный массив записываем первое значение из промежуточно, чтобы дальше прибавлять(в целом не очень нужный шаг, я так думаю, просто мне так было легче для понимания)
for i1 = 2:length(L1)
S_i1_1(1, :) = S_i1_1(1, :) + S_i1(i1, :);
end//второй раз проходимся циклом, только уже начиная со второго элемента в промежуточном массиве, тем самым выполняя саму сумму из формулы в методичке(формула спектра последовательности сигналов)
S_i1_1(1, :) = abs(S_i1_1(1, :));//берем от полученного спектра модуль, делая его амплитудным